<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
  }
  body {
    display: flex;
    flex-direction: row;
  }
  iframe {
    border: none;
  }

  @media (orientation: landscape) {
    body {
      flex-direction: row;
    }
    #iframe1 {
      width: 75%;
      height: 100%;
    }
    #iframe2 {
      width: 25%;
      height: 100%;
    }
  }

  @media (orientation: portrait) {
    body {
      flex-direction: column;
    }
    #iframe1 {
      width: 100%;
      height: 50%;
    }
    #iframe2 {
      width: 100%;
      height: 50%;
    }
  }
  #popupButton {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
    filter: opacity(0.5);
  }

  #popupButton:hover {
    filter: opacity(1);
  }
</style>
</head>
<body>
  <script>
    function fnv1a64(str) {
        const FNV_OFFSET_BASIS = BigInt("14695981039346656037");
        const FNV_PRIME = BigInt("1099511628211");
        let hash = FNV_OFFSET_BASIS;
        for (let i = 0; i < str.length; i++) {
            hash ^= BigInt(str.charCodeAt(i));
            hash = (hash * FNV_PRIME) & BigInt("0xFFFFFFFFFFFFFFFF");
        }
        return hash.toString(16).padStart(16, "0");
    }

    function randomString(length) {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        let result = '';
        for (let i = 0; i < length; i++) {
            result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
    }

    let iframeUrl = "./hls.html" + location.hash + "?t=" + randomString(8); 
    let iframe = document.createElement("iframe");
    iframe.id = "iframe1";
    iframe.src = iframeUrl;
    document.body.appendChild(iframe);
    let chatUrl = function () {
      // return "https://hack.chat?" + "ezl" + fnv1a64(location.hash) + '#' + randomString(8);
      return 'https://raye.mistivia.com/irc/auto.html?nick=u' + randomString(8) + '#ezl' + fnv1a64(location.hash);
    };


    iframeUrl = chatUrl();
    iframe = document.createElement("iframe");
    iframe.id = "iframe2";
    iframe.src = iframeUrl;
    document.body.appendChild(iframe);

        function openPopup(url) {
        const windowFeatures = `
            width=250,
            height=900,
            toolbar=no,
            menubar=no,
            scrollbars=yes,
            resizable=yes,
            location=no,
            status=no
        `.replace(/\s+/g, '');
        const popup = window.open(url, "popupWindow", windowFeatures);
    }
    let popupUrl = chatUrl();
    function popup() {
        openPopup(popupUrl);
    }

  </script>
  <button id="popupButton" onclick="popup()">Popup Chat</button>
</body>
</html>
